<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Fan()</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="Fan()">
<meta property="og:url" content="http://fuxkdb.com/page/18/index.html">
<meta property="og:site_name" content="Fan()">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="大范">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Fan()" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpeg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpeg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt; src:url("/css/fonts/FuturaPTBold.otf") format("woff");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt-light; src:url("/css/fonts/FuturaPTBook.otf") format("woff");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt-italic; src:url("/css/fonts/FuturaPTBookOblique.otf") format("woff");font-weight:400;font-style:italic;}
}

  </style>
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>

  
<script src="/js/bootstrap.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="/css/home.css" >
  

  

  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

<meta name="generator" content="Hexo 5.1.1"></head>



  <body>


  
    <header id="header">

	<!-- 背景图模式 -->
	

    
      <div id="intrologo" class="intro-logo" style="background-position:center; background-repeat:no-repeat; background-image: url(); background-size: auto 100%;">

      <!-- Support rolling -->  
        
        <section class="awSlider">
          <div class="carousel slide carousel-fade " data-ride="carousel">

            <!-- Wrapper for slides -->
            <div class="carousel-inner">
               
                  
                    <div class="item active">
                  
                    <img id="carousel-img0" src="/css/images/1.jpg">
                  </div>

                  <!-- 自适应大图 -->
                  <script>
                      var img0 = new Image();
                      var imageTag0 = document.getElementById("carousel-img0");
                      img0.src = imageTag0.src;
                      img0.onload=function(){
                        if (img0.width / img0.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag0.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag0.style.height = document.body.clientHeight + "px";
                          imageTag0.style.marginLeft = -(document.body.clientHeight * img0.width / img0.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img1" src="/css/images/2.jpg">
                  </div>

                  <!-- 自适应大图 -->
                  <script>
                      var img1 = new Image();
                      var imageTag1 = document.getElementById("carousel-img1");
                      img1.src = imageTag1.src;
                      img1.onload=function(){
                        if (img1.width / img1.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag1.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag1.style.height = document.body.clientHeight + "px";
                          imageTag1.style.marginLeft = -(document.body.clientHeight * img1.width / img1.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img2" src="/css/images/3.jpg">
                  </div>

                  <!-- 自适应大图 -->
                  <script>
                      var img2 = new Image();
                      var imageTag2 = document.getElementById("carousel-img2");
                      img2.src = imageTag2.src;
                      img2.onload=function(){
                        if (img2.width / img2.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag2.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag2.style.height = document.body.clientHeight + "px";
                          imageTag2.style.marginLeft = -(document.body.clientHeight * img2.width / img2.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img3" src="/css/images/4.jpg">
                  </div>

                  <!-- 自适应大图 -->
                  <script>
                      var img3 = new Image();
                      var imageTag3 = document.getElementById("carousel-img3");
                      img3.src = imageTag3.src;
                      img3.onload=function(){
                        if (img3.width / img3.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag3.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag3.style.height = document.body.clientHeight + "px";
                          imageTag3.style.marginLeft = -(document.body.clientHeight * img3.width / img3.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img4" src="/css/images/5.jpeg">
                  </div>

                  <!-- 自适应大图 -->
                  <script>
                      var img4 = new Image();
                      var imageTag4 = document.getElementById("carousel-img4");
                      img4.src = imageTag4.src;
                      img4.onload=function(){
                        if (img4.width / img4.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag4.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag4.style.height = document.body.clientHeight + "px";
                          imageTag4.style.marginLeft = -(document.body.clientHeight * img4.width / img4.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
            </div>

            <!-- Controls -->
            <a class="left carousel-control" href=".carousel" role="button" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">Geri</span>
            </a>
            <a class="right carousel-control" href=".carousel" role="button" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">İleri</span>
            </a>
          </div>
        </section>
        <script>
          $('section.awSlider .carousel').carousel({
              pause: '',
              interval: 5000
          });
          var startImage = $('section.awSlider .item.active > img').attr('src');
          $('section.awSlider .carousel').on('slid.bs.carousel', function () {
              var bscn = $(this).find('.item.active > img').attr('src');
              $('section.awSlider > img').attr('src', bscn);
          });
        </script>
      

    
 


    <canvas width="100%" height="100%"></canvas>
    <script>
      var c = document.getElementsByTagName('canvas')[0],
          x = c.getContext('2d'),
          w = window.innerWidth,
          h = window.innerHeight,
          pr = window.devicePixelRatio || 1,
          f = 90,
          q,
          m = Math,
          r = 0,
          u = m.PI*2,
          v = m.cos,
          z = m.random
      c.width = w*pr
      c.height = h*pr
      x.scale(pr, pr)
      x.globalAlpha = 0.6

      <!-- 折线Polyline背景 -->
      
    </script>
    

    
      <div id="homelogo" class="homelogo" style="background: rgba(255,255,255,1);"> 
    

        
          <div class="homelogoback"  style="border: 1px solid #404040;" >
            <h1><a href="#content" id="logo">Fan()</a></h1>
            <h3></h3>
            <h5>大范</h5>
            <!-- <p><a href="https://github.com/iTimeTraveler" target="_blank">Github</a></p> -->
          </div>
        
    
    </div>
  </div>

  <!-- 自适应主页背景大图 -->
  

 <!-- home_logo_image居中 -->
 
    <script>
        var homelogodiv = document.getElementById("homelogo");
        if (document.all.homelogo.offsetWidth > document.body.clientWidth) {
          homelogodiv.style.width = document.body.clientWidth + "px";
          homelogodiv.style.marginLeft = document.body.clientWidth * -0.5 + "px";
        } else {
          homelogodiv.style.width = homelogodiv.clientWidth  + "px";
          homelogodiv.style.marginLeft = (homelogodiv.clientWidth)  * -0.5 + "px";
        }
    </script>
  

  <div class="intro-navigate">
      <p class="navigater-list">
        
          <a id="beautifont" class="main-nav-link" href="/">首页</a>
        
          <a id="beautifont" class="main-nav-link" href="/archives">归档</a>
        
          <a id="beautifont" class="main-nav-link" href="/tags">标签</a>
        
          <a id="beautifont" class="main-nav-link" href="/about">关于</a>
        
      </p>
  </div>

</header>
  
  <div id="container">
    <div id="wrap">
      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;">
  
    <article id="post-MySQL误DROP表恢复,innodb_file_per_table=OFF"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/27/MySQL%E8%AF%AFDROP%E8%A1%A8%E6%81%A2%E5%A4%8D,innodb_file_per_table=OFF/">MySQL误DROP表恢复,innodb_file_per_table=OFF</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/27/MySQL%E8%AF%AFDROP%E8%A1%A8%E6%81%A2%E5%A4%8D,innodb_file_per_table=OFF/" class="article-date">
	  <time datetime="2016-12-27T14:00:00.000Z" itemprop="datePublished">2016-12-27</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MySQL误DROP表恢复-innodb-file-per-table-OFF"><a href="#MySQL误DROP表恢复-innodb-file-per-table-OFF" class="headerlink" title="MySQL误DROP表恢复,innodb_file_per_table=OFF"></a>MySQL误DROP表恢复,innodb_file_per_table=OFF</h1><p>原文<a target="_blank" rel="noopener" href="https://twindb.com/recover-after-drop-table-innodb_file_per_table-is-off/">https://twindb.com/recover-after-drop-table-innodb_file_per_table-is-off/</a></p>
<h2 id="Undrop-for-innodb安装"><a href="#Undrop-for-innodb安装" class="headerlink" title="Undrop-for-innodb安装"></a>Undrop-for-innodb安装</h2><p>详见<a target="_blank" rel="noopener" href="https://github.com/chhabhaiya/undrop-for-innodb">https://github.com/chhabhaiya/undrop-for-innodb</a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>误操作是不可避免的.错误的DROP DATABASE或DROP TABLE会摧毁重要的数据,更悲剧的是备份又不可用.<br>恢复方法取决于InnoDB是将所有数据保存在单个ibdata1中还是每个表都有自己的表空间.在这篇文章中,我们将考虑innodb_file_per_table = OFF的情况.此选项假定所有表都存储在通用文件中,通常位于/var/lib/mysql/ibdata1.</p>
<h2 id="误删表恢复"><a href="#误删表恢复" class="headerlink" title="误删表恢复"></a>误删表恢复</h2><p>这里使用sakila库,假设我们误删除了actor表<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM actor LIMIT 10;</span><br><span class="line"><span class="code">+----------+</span>------------<span class="code">+--------------+</span>---------------------+</span><br><span class="line">| actor<span class="emphasis">_id | first_</span>name | last<span class="emphasis">_name    | last_</span>update         |</span><br><span class="line"><span class="code">+----------+</span>------------<span class="code">+--------------+</span>---------------------+</span><br><span class="line">|        1 | PENELOPE   | GUINESS      | 2006-02-15 04:34:33 |</span><br><span class="line">|        2 | NICK       | WAHLBERG     | 2006-02-15 04:34:33 |</span><br><span class="line">|        3 | ED         | CHASE        | 2006-02-15 04:34:33 |</span><br><span class="line">|        4 | JENNIFER   | DAVIS        | 2006-02-15 04:34:33 |</span><br><span class="line">|        5 | JOHNNY     | LOLLOBRIGIDA | 2006-02-15 04:34:33 |</span><br><span class="line">|        6 | BETTE      | NICHOLSON    | 2006-02-15 04:34:33 |</span><br><span class="line">|        7 | GRACE      | MOSTEL       | 2006-02-15 04:34:33 |</span><br><span class="line">|        8 | MATTHEW    | JOHANSSON    | 2006-02-15 04:34:33 |</span><br><span class="line">|        9 | JOE        | SWANK        | 2006-02-15 04:34:33 |</span><br><span class="line">|       10 | CHRISTIAN  | GABLE        | 2006-02-15 04:34:33 |</span><br><span class="line"><span class="code">+----------+</span>------------<span class="code">+--------------+</span>---------------------+</span><br><span class="line">10 rows in set (0.02 sec)</span><br><span class="line"></span><br><span class="line">查看一下checksum</span><br><span class="line">mysql&gt; CHECKSUM TABLE actor;</span><br><span class="line"><span class="code">+--------------+</span>------------+</span><br><span class="line">| Table        | Checksum   |</span><br><span class="line"><span class="code">+--------------+</span>------------+</span><br><span class="line">| sakila.actor | 1702520518 |</span><br><span class="line"><span class="code">+--------------+</span>------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(<span class="strong">*) from actor;</span></span><br><span class="line"><span class="strong">+----------+</span></span><br><span class="line"><span class="strong">| count(*</span>) |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">|      200 |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">1 row in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DROP TABLE actor;</span><br><span class="line">Query OK, 0 rows affected (0.03 sec)</span><br></pre></td></tr></table></figure><br>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-恢复表结构"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/27/%E6%81%A2%E5%A4%8D%E8%A1%A8%E7%BB%93%E6%9E%84/">恢复表结构</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/27/%E6%81%A2%E5%A4%8D%E8%A1%A8%E7%BB%93%E6%9E%84/" class="article-date">
	  <time datetime="2016-12-27T14:00:00.000Z" itemprop="datePublished">2016-12-27</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="恢复表结构"><a href="#恢复表结构" class="headerlink" title="恢复表结构"></a>恢复表结构</h2><p>此文档适用于.frm文件丢失,并且没有备份情况下恢复出建表语句</p>
<h3 id="恢复InnoDB字典表"><a href="#恢复InnoDB字典表" class="headerlink" title="恢复InnoDB字典表"></a>恢复InnoDB字典表</h3><p>首先创建用于恢复的字典辅助表<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database sakila<span class="emphasis">_recovered;</span></span><br><span class="line"><span class="emphasis">Query OK, 1 row affected (0.01 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">[mysql@master undrop-for-innodb]$ cat dictionary/SYS_</span>* | mysql -umysql -pmysql -S /data/mysqldata/3307/mysql.sock sakila<span class="emphasis">_recovered</span></span><br><span class="line"><span class="emphasis">Warning: Using a password on the command line interface can be insecure.</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; show tables;</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">| Tables_</span>in<span class="emphasis">_sakila_</span>recovered |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">| SYS<span class="emphasis">_COLUMNS                |</span></span><br><span class="line"><span class="emphasis">| SYS_</span>FIELDS                 |</span><br><span class="line">| SYS<span class="emphasis">_INDEXES                |</span></span><br><span class="line"><span class="emphasis">| SYS_</span>TABLES                 |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><br>字典表存储在ibdata1中,所以要解析它<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">mysql@</span>master undrop-<span class="keyword">for</span>-innodb]$ ./stream_parser -f /data/mysqldata/<span class="number">3307</span>/data/ibdata1 </span><br><span class="line">Opening file: /data/mysqldata/<span class="number">3307</span>/data/ibdata1</span><br><span class="line">File information:</span><br><span class="line"></span><br><span class="line">ID of device containing file:        <span class="number">64768</span></span><br><span class="line">inode number:                    <span class="number">104900755</span></span><br><span class="line">protection:                         <span class="number">100660</span> (regular file)</span><br><span class="line">number of hard links:                    <span class="number">1</span></span><br><span class="line">user ID of owner:                       <span class="number">27</span></span><br><span class="line">group ID of owner:                      <span class="number">27</span></span><br><span class="line">device ID (<span class="keyword">if</span> special file):             <span class="number">0</span></span><br><span class="line">blocksize <span class="keyword">for</span> filesystem I/O:         <span class="number">4096</span></span><br><span class="line">number of blocks allocated:        <span class="number">4194304</span></span><br><span class="line">time of last access:            <span class="number">1482819237</span> Tue Dec <span class="number">27</span> <span class="number">14</span>:<span class="number">13</span>:<span class="number">57</span> <span class="number">2016</span></span><br><span class="line">time of last modification:      <span class="number">1482819237</span> Tue Dec <span class="number">27</span> <span class="number">14</span>:<span class="number">13</span>:<span class="number">57</span> <span class="number">2016</span></span><br><span class="line">time of last status change:     <span class="number">1482819237</span> Tue Dec <span class="number">27</span> <span class="number">14</span>:<span class="number">13</span>:<span class="number">57</span> <span class="number">2016</span></span><br><span class="line">total size, <span class="keyword">in</span> bytes:           <span class="number">2147483648</span> (<span class="number">2.000</span> GiB)</span><br><span class="line"></span><br><span class="line">Size to process:                <span class="number">2147483648</span> (<span class="number">2.000</span> GiB)</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">5.47</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">21</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">18</span>). Processing speed: <span class="number">104.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">13.67</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">14</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">10</span>). Processing speed: <span class="number">168.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">22.66</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">13</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">08</span>). Processing speed: <span class="number">184.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">28.52</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">18</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">12</span>). Processing speed: <span class="number">120.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">35.94</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">15</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">08</span>). Processing speed: <span class="number">152.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">43.75</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">15</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">07</span>). Processing speed: <span class="number">160.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">51.17</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">15</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">06</span>). Processing speed: <span class="number">152.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">57.81</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">16</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">06</span>). Processing speed: <span class="number">136.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">64.45</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">16</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">05</span>). Processing speed: <span class="number">136.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">71.48</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">16</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">04</span>). Processing speed: <span class="number">144.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">78.91</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">15</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">02</span>). Processing speed: <span class="number">152.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">85.16</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">16</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">02</span>). Processing speed: <span class="number">128.000</span> MiB/sec</span><br><span class="line">Worker(<span class="number">0</span>): <span class="number">92.19</span>% done. <span class="number">2016</span><span class="number">-12</span><span class="number">-27</span> <span class="number">14</span>:<span class="number">24</span>:<span class="number">16</span> ETA(<span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>). Processing speed: <span class="number">144.000</span> MiB/sec</span><br><span class="line">All workers finished <span class="keyword">in</span> <span class="number">13</span> sec</span><br><span class="line"></span><br><span class="line">Data <span class="keyword">from</span> database pages <span class="keyword">is</span> saved by the stream_parser to folder pages-ibdata1:</span><br><span class="line">[<span class="symbol">mysql@</span>master undrop-<span class="keyword">for</span>-innodb]$ tree pages-ibdata1/</span><br><span class="line">pages-ibdata1/</span><br><span class="line">├── FIL_PAGE_INDEX</span><br><span class="line">│   ├── <span class="number">0000000000000001.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000002.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000003.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000004.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000005.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000011.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000012.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000013.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000014.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000015.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000016.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000017.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000018.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000019.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000020.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000021.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000022.</span>page</span><br><span class="line">│   ├── <span class="number">0000000000000023.</span>page</span><br><span class="line">│   └── <span class="number">18446744069414584320.</span>page</span><br><span class="line">└── FIL_PAGE_TYPE_BLOB</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> directories, <span class="number">19</span> files</span><br></pre></td></tr></table></figure><br>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-MySQL误DROP表恢复,innodb_file_per_table=ON"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/26/MySQL%E8%AF%AFDROP%E8%A1%A8%E6%81%A2%E5%A4%8D,innodb_file_per_table=ON/">MySQL误DROP表恢复,innodb_file_per_table=ON</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/26/MySQL%E8%AF%AFDROP%E8%A1%A8%E6%81%A2%E5%A4%8D,innodb_file_per_table=ON/" class="article-date">
	  <time datetime="2016-12-26T14:00:00.000Z" itemprop="datePublished">2016-12-26</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MySQL误DROP表恢复-innodb-file-per-table-ON"><a href="#MySQL误DROP表恢复-innodb-file-per-table-ON" class="headerlink" title="MySQL误DROP表恢复,innodb_file_per_table=ON"></a>MySQL误DROP表恢复,innodb_file_per_table=ON</h1><blockquote>
<p>参考<br><a target="_blank" rel="noopener" href="https://twindb.com/recover-after-drop-table-innodb_file_per_table-is-on/">https://twindb.com/recover-after-drop-table-innodb_file_per_table-is-on/</a></p>
</blockquote>
<h2 id="Undrop-for-innodb安装"><a href="#Undrop-for-innodb安装" class="headerlink" title="Undrop-for-innodb安装"></a>Undrop-for-innodb安装</h2><p>详见<a target="_blank" rel="noopener" href="https://github.com/chhabhaiya/undrop-for-innodb">https://github.com/chhabhaiya/undrop-for-innodb</a></p>
<h2 id="删除Country表并恢复"><a href="#删除Country表并恢复" class="headerlink" title="删除Country表并恢复"></a>删除Country表并恢复</h2><p>使用sakila示例数据库作为例子,sakila相当于Oracle的SCOTT<br>innodb每个表包含两个文件.frm文件包含建表语句.ibd文件包含数据<br><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">mysql@</span>master sakila]$ ll country.*</span><br><span class="line">-rw-r----- <span class="number">1</span> mysql mysql  <span class="number">8652</span> Aug <span class="number">26</span> <span class="number">14</span>:<span class="number">25</span> country.frm</span><br><span class="line">-rw-r----- <span class="number">1</span> mysql mysql <span class="number">98304</span> Aug <span class="number">26</span> <span class="number">14</span>:<span class="number">25</span> country.ibd</span><br></pre></td></tr></table></figure></p>
<p>接下来删除country表,删之前看一下checksum<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">SESSION<span class="emphasis">_A&gt; use sakila</span></span><br><span class="line"><span class="emphasis">Database changed</span></span><br><span class="line"><span class="emphasis">SESSION_</span>A&gt; select count(<span class="strong">*) from country;</span></span><br><span class="line"><span class="strong">+----------+</span></span><br><span class="line"><span class="strong">| count(*</span>) |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">|      109 |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">1 row in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">SESSION<span class="emphasis">_A&gt;checksum table country;</span></span><br><span class="line"><span class="emphasis">+---------------------+------------+</span></span><br><span class="line"><span class="emphasis">| Table               | Checksum   |</span></span><br><span class="line"><span class="emphasis">+---------------------+------------+</span></span><br><span class="line"><span class="emphasis">| sakila.country      | 2039770088 |</span></span><br><span class="line"><span class="emphasis">+---------------------+------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br></pre></td></tr></table></figure><br>接下来删除country表<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">SESSION_A</span>&gt;drop table country;</span><br><span class="line"><span class="attribute">Query</span> OK, <span class="number">0</span> rows affected (<span class="number">0</span>.<span class="number">01</span> sec)</span><br></pre></td></tr></table></figure></p>
<p>drop table后,.frm和.ibd文件也被删除了<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysql@<span class="keyword">master</span> <span class="title">sakila</span>]$ ll country*</span><br><span class="line">ls: cannot access country*: No such file <span class="keyword">or</span> directory</span><br></pre></td></tr></table></figure><br>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-Auto_increment-产生-GAP的原因"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/20/Auto_increment-%E4%BA%A7%E7%94%9F-GAP%E7%9A%84%E5%8E%9F%E5%9B%A0/">Auto_increment 产生 GAP的原因</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/20/Auto_increment-%E4%BA%A7%E7%94%9F-GAP%E7%9A%84%E5%8E%9F%E5%9B%A0/" class="article-date">
	  <time datetime="2016-12-20T14:00:00.000Z" itemprop="datePublished">2016-12-20</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文<br><a target="_blank" rel="noopener" href="http://thenoyes.com/littlenoise/?p=187">http://thenoyes.com/littlenoise/?p=187</a></p>
<h2 id="Auto-increment-产生-GAP的原因"><a href="#Auto-increment-产生-GAP的原因" class="headerlink" title="Auto_increment 产生 GAP的原因"></a>Auto_increment 产生 GAP的原因</h2><p>Why are there gaps in my auto_increment sequence, even if there are no deletes or rolled back transactions?<br>Is it a bug?<br>The manual says, “For lock modes 1 or 2, gaps may occur between successive statements because for bulk inserts the exact number of auto-increment values required by each statement may not be known and overestimation is possible.”<br>Where does that overestimation come from?<br>An example to illustrate:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> t;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t (a <span class="built_in">bigint</span> <span class="keyword">unsigned</span> auto_increment primary <span class="keyword">key</span>) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">SELECT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> a;</span><br><span class="line"><span class="comment">/* #1 */</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t <span class="keyword">SELECT</span> <span class="literal">NULL</span> <span class="keyword">FROM</span> t;</span><br><span class="line"><span class="comment">/* #2 */</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t <span class="keyword">SELECT</span> <span class="literal">NULL</span> <span class="keyword">FROM</span> t;</span><br><span class="line"><span class="comment">/* #3 */</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t <span class="keyword">SELECT</span> <span class="literal">NULL</span> <span class="keyword">FROM</span> t;</span><br><span class="line"><span class="comment">/* #4 */</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t <span class="keyword">SELECT</span> <span class="literal">NULL</span> <span class="keyword">FROM</span> t;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t;</span><br><span class="line"></span><br><span class="line">+<span class="comment">----+</span></span><br><span class="line">| a |</span><br><span class="line">+<span class="comment">----+</span></span><br><span class="line">| 1 |</span><br><span class="line">| 2 |</span><br><span class="line">| 3 |</span><br><span class="line">| 4 |</span><br><span class="line">| 6 |</span><br><span class="line">| 7 |</span><br><span class="line">| 8 |</span><br><span class="line">| 9 |</span><br><span class="line">| 13 |</span><br><span class="line">| 14 |</span><br><span class="line">| 15 |</span><br><span class="line">| 16 |</span><br><span class="line">| 17 |</span><br><span class="line">| 18 |</span><br><span class="line">| 19 |</span><br><span class="line">| 20 |</span><br><span class="line">+<span class="comment">----+</span></span><br><span class="line">16 rows in <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-AUTO-INC锁和AUTO_INCREMENT在InnoDB中处理方式"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/15/AUTO-INC%E9%94%81%E5%92%8CAUTO_INCREMENT%E5%9C%A8InnoDB%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/">AUTO-INC锁和AUTO_INCREMENT在InnoDB中处理方式</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/15/AUTO-INC%E9%94%81%E5%92%8CAUTO_INCREMENT%E5%9C%A8InnoDB%E4%B8%AD%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/" class="article-date">
	  <time datetime="2016-12-15T14:00:00.000Z" itemprop="datePublished">2016-12-15</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="AUTO-INC-Locks"><a href="#AUTO-INC-Locks" class="headerlink" title="AUTO-INC Locks"></a>AUTO-INC Locks</h2><blockquote>
<p>An AUTO-INC lock is a special table-level lock taken by transactions inserting into tables with AUTO_INCREMENT columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.</p>
</blockquote>
<p>The innodb_autoinc_lock_mode configuration option controls the algorithm used for auto-increment locking. It allows you to choose how to trade off between predictable sequences of auto-increment values and maximum concurrency for insert operations.</p>
<p>AUTO-INC锁是当向使用含有AUTO_INCREMENT列的表中插入数据时需要获取的一种特殊的表级锁<br>在最简单的情况下，如果一个事务正在向表中插入值，则任何其他事务必须等待对该表执行自己的插入操作，以便第一个事务插入的行的值是连续的。<br>innodb_autoinc_lock_mode配置选项控制用于自动增量锁定的算法。 它允许您选择如何在可预测的自动递增值序列和插入操作的最大并发性之间进行权衡。</p>
<h2 id="AUTO-INCREMENT-Handling-in-InnoDB"><a href="#AUTO-INCREMENT-Handling-in-InnoDB" class="headerlink" title="AUTO_INCREMENT Handling in InnoDB"></a>AUTO_INCREMENT Handling in InnoDB</h2><p>InnoDB提供了一个可配置的锁定机制，可以显着提高使用AUTO_INCREMENT列向表中添加行的SQL语句的可伸缩性和性能。 要对InnoDB表使用AUTO_INCREMENT机制，必须将AUTO_INCREMENT列定义为索引的一部分，以便可以对表执行相当于索引的<code>SELECT MAX（ai_col）</code>查找以获取最大列值。 通常，这是通过使列成为某些表索引的第一列来实现的。</p>
<p>本节介绍AUTO_INCREMENT锁定模式的行为，对不同AUTO_INCREMENT锁定模式设置的使用含义，以及InnoDB如何初始化AUTO_INCREMENT计数器。</p>
<ul>
<li><p>InnoDB AUTO_INCREMENT锁定模式</p>
</li>
<li><p>InnoDB AUTO_INCREMENT锁定模式使用含义</p>
</li>
<li><p>InnoDB AUTO_INCREMENT计数器初始化</p>
</li>
</ul>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-Innodb事务隔离级别"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2016/12/13/Innodb%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/">Innodb事务隔离级别</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2016/12/13/Innodb%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/" class="article-date">
	  <time datetime="2016-12-13T14:00:00.000Z" itemprop="datePublished">2016-12-13</time>
	</a>

      
      
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Innodb事务隔离级别"><a href="#Innodb事务隔离级别" class="headerlink" title="Innodb事务隔离级别"></a>Innodb事务隔离级别</h2><h3 id="REPEATABLE-READ"><a href="#REPEATABLE-READ" class="headerlink" title="REPEATABLE READ"></a>REPEATABLE READ</h3><blockquote>
<p>This is the default isolation level for InnoDB. Consistent reads within the same transaction read the snapshot established by the first read. This means that if you issue several plain (nonlocking) SELECT statements within the same transaction, these SELECT statements are consistent also with respect to each other.</p>
</blockquote>
<p>这是 InnoDB 默认的事务隔离级别,同一事物通过第一次创建的快照来构造一致性读.这意味着如果你在同一会话执行多次查询(非锁定读),那么每次获取的结果都是彼此相等的</p>
<blockquote>
<p>For locking reads (SELECT with FOR UPDATE or LOCK IN SHARE MODE), UPDATE, and DELETE statements, locking depends on whether the statement uses a unique index with a unique search condition, or a range-type search condition.</p>
</blockquote>
<p>对于锁定读,(SELECT with FOR UPDATE or LOCK IN SHARE MODE), UPDATE, 和 DELETE语句,是否锁定取决于此次查询(UPDATE DELETE 也是一种查询)是否通过唯一条件或范围条件查询使用唯一索引</p>
<blockquote>
<p>For a unique index with a unique search condition, InnoDB locks only the index record found, not the gap before it.</p>
</blockquote>
<ul>
<li>For a unique index with a unique search condition,InnoDB只锁索引记录,不锁 gap<ul>
<li>For other search conditions, InnoDB locks the index range scanned, using gap locks or next-key locks to block insertions by other sessions into the gaps covered by the range</li>
</ul>
</li>
</ul>
<h3 id="READ-COMMITTED"><a href="#READ-COMMITTED" class="headerlink" title="READ COMMITTED"></a>READ COMMITTED</h3><blockquote>
<p>Each consistent read, even within the same transaction, sets and reads its own fresh snapshot. For information about consistent reads</p>
</blockquote>
<p>read view在 innodb 如何避免幻读中已经介绍过</p>
<blockquote>
<p>For locking reads (SELECT with FOR UPDATE or LOCK IN SHARE MODE), UPDATE statements, and DELETE statements, InnoDB locks only index records, not the gaps before them, and thus permits the free insertion of new records next to locked records. Gap locking is only used for foreign-key constraint checking and duplicate-key checking.</p>
</blockquote>
<p>locking reads(SELECT with FOR UPDATE or LOCK IN SHARE MODE),UPDATE 语句,DELETE语句,InnoDB 都只会锁index records(也就是 record lock),不会产生 gap lock,因此允许在 gap 中插入新的 records.Gap locking只在外键约束检查和重复值检查时产生</p>
<blockquote>
<p>Because gap locking is disabled, phantom problems may occur, as other sessions can insert new rows into the gaps</p>
</blockquote>
<p>因为gap locking被 disabled,幻读问题可能会产生,其他会话可以在 gap 中插入新的记录</p>
      
    </div>
    <footer class="article-footer">
      
      
      
      

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  


  <nav id="page-nav">
    <!--  -->
    
    <a class="extend prev" rel="prev" href="/page/17/">« 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/19/">下一页 »</a>
  </nav>

</section>
        
      </div>
      
        <div align="center" style="margin-top: 30px;"><hr class="hr" style="margin:0px; height:3px;"></div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2021 Fan() All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				访客数 : <span id="busuanzi_value_site_uv"></span> |  
				访问量 : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/scripts.js"></script>



  
<script src="/js/home.js"></script>











	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Fan()
          </div>
          <div class="panel-body">
            Copyright © 2021 大范 All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
</body>
</html>